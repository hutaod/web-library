# React 同构渲染探索

## 背景

组内 `c端` 前端框架体系的核心是 `Next.js` ，但基于其源码直接改写的方式，造成了框架及其周边第三方库的升级困难问题，这个问题持续了 4 年，2 年前重构框架代码的时候就已经抛出这个问题，但是因为已经大批量用于生产项目，再加上成本问题，最终还是没有避免改源码的这个问题，但也减少了一些对源码的直接改动，只是在源码上进行了一些增量改动，直到最近才有比较多的时间再来梳理这一个问题。

对框架源代码进行改动的重要原因之一就是：高并发会导致 nodejs 服务性能变差，响应变慢，甚至因为 有段时间发现 nextjs 框架有内存泄露的问题，导致nodejs服务不断重启。

于是就对源码扩展了 `动态降级` 的功能，可以根据服务端性能情况进行动态分配走 `ssr渲染` 还是渲染已打包好的静态 html 资源。

前段时间发现 `动态降级率` 暴涨，于是对其进行了多方面的分析，分析了其原因以及优化的方向。再加上打算升级框架，并脱离直接修改源码的方案，于是重新再去了解了一下nextjs，对 React 如何实现同构渲染，以及我们工作中一般会怎么去选择渲染模式进行了分析和总结。

## 常见的渲染模式

## Next.js 的渲染方案

## 我们公司C端的渲染方案

## 最佳实践

## 最后